(() => {
var exports = {};
exports.id = 500;
exports.ids = [500];
exports.modules = {

/***/ 18038:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react");

/***/ }),

/***/ 98704:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react-dom/server-rendering-stub");

/***/ }),

/***/ 97897:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react-server-dom-webpack/client");

/***/ }),

/***/ 56786:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react/jsx-runtime");

/***/ }),

/***/ 5868:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/app-render");

/***/ }),

/***/ 41844:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/get-segment-param");

/***/ }),

/***/ 96624:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/future/helpers/interception-routes");

/***/ }),

/***/ 75281:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/future/route-modules/route-module");

/***/ }),

/***/ 57085:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/app-router-context");

/***/ }),

/***/ 1830:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/get-img-props");

/***/ }),

/***/ 20199:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/hash");

/***/ }),

/***/ 66864:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/head");

/***/ }),

/***/ 39569:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/hooks-client-context");

/***/ }),

/***/ 52210:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/image-config");

/***/ }),

/***/ 35359:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/image-config-context");

/***/ }),

/***/ 17160:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router-context");

/***/ }),

/***/ 30893:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/add-path-prefix");

/***/ }),

/***/ 12336:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/format-url");

/***/ }),

/***/ 17887:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/handle-smooth-scroll");

/***/ }),

/***/ 98735:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/is-bot");

/***/ }),

/***/ 60120:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/is-local-url");

/***/ }),

/***/ 68231:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/parse-path");

/***/ }),

/***/ 54614:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/path-has-prefix");

/***/ }),

/***/ 53750:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/remove-trailing-slash");

/***/ }),

/***/ 70982:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/resolve-href");

/***/ }),

/***/ 79618:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/server-inserted-html");

/***/ }),

/***/ 78423:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/utils");

/***/ }),

/***/ 98658:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/utils/warn-once");

/***/ }),

/***/ 39491:
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ 82361:
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ 57147:
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ 13685:
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ 95687:
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ 22037:
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ 71017:
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ 12781:
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ 76224:
/***/ ((module) => {

"use strict";
module.exports = require("tty");

/***/ }),

/***/ 57310:
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ 73837:
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ 59796:
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ 57344:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GlobalError: () => (/* reexport default from dynamic */ next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_2___default.a),
/* harmony export */   __next_app__: () => (/* binding */ __next_app__),
/* harmony export */   originalPathname: () => (/* binding */ originalPathname),
/* harmony export */   pages: () => (/* binding */ pages),
/* harmony export */   routeModule: () => (/* binding */ routeModule),
/* harmony export */   tree: () => (/* binding */ tree)
/* harmony export */ });
/* harmony import */ var next_dist_server_future_route_modules_app_page_module__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(7346);
/* harmony import */ var next_dist_server_future_route_modules_app_page_module__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_page_module__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(11367);
/* harmony import */ var next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2332);
/* harmony import */ var next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var next_dist_server_app_render_entry_base__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(94408);
/* harmony import */ var next_dist_server_app_render_entry_base__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_app_render_entry_base__WEBPACK_IMPORTED_MODULE_3__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in next_dist_server_app_render_entry_base__WEBPACK_IMPORTED_MODULE_3__) if(["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => next_dist_server_app_render_entry_base__WEBPACK_IMPORTED_MODULE_3__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
// @ts-ignore this need to be imported from next/dist to be external


const AppPageRouteModule = next_dist_server_future_route_modules_app_page_module__WEBPACK_IMPORTED_MODULE_0__.AppPageRouteModule;
// We inject the tree and pages here so that we can use them in the route
// module.
const tree = {
        children: [
        '',
        {
        children: [
        '(preview)',
        {
        children: [
        'upload',
        {
        children: ['__PAGE__', {}, {
          page: [() => Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 23439)), "E:\\HTML CSS JS\\tanish\\app\\(preview)\\upload\\page.tsx"],
          
        }]
      },
        {
        
        
      }
      ]
      },
        {
        'layout': [() => Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 70267)), "E:\\HTML CSS JS\\tanish\\app\\(preview)\\layout.tsx"],
'not-found': [() => Promise.resolve(/* import() eager */).then(__webpack_require__.t.bind(__webpack_require__, 82718, 23)), "next/dist/client/components/not-found-error"],
        metadata: {
    icon: [(async (props) => (await Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 30226))).default(props))],
    apple: [],
    openGraph: [],
    twitter: [],
    manifest: undefined
  }
      }
      ]
      },
        {
        'layout': [() => Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 49993)), "E:\\HTML CSS JS\\tanish\\app\\layout.tsx"],
'not-found': [() => Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 69214)), "E:\\HTML CSS JS\\tanish\\app\\not-found.tsx"],
        metadata: {
    icon: [(async (props) => (await Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 30226))).default(props))],
    apple: [],
    openGraph: [],
    twitter: [],
    manifest: undefined
  }
      }
      ]
      }.children;
const pages = ["E:\\HTML CSS JS\\tanish\\app\\(preview)\\upload\\page.tsx"];

// @ts-expect-error - replaced by webpack/turbopack loader

const __next_app_require__ = __webpack_require__
const __next_app_load_chunk__ = () => Promise.resolve()
const originalPathname = "/(preview)/upload/page";
const __next_app__ = {
    require: __next_app_require__,
    loadChunk: __next_app_load_chunk__
};

// Create and export the route module that will be consumed.
const routeModule = new AppPageRouteModule({
    definition: {
        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_PAGE,
        page: "/(preview)/upload/page",
        pathname: "/upload",
        // The following aren't used in production.
        bundlePath: "",
        filename: "",
        appPaths: []
    },
    userland: {
        loaderTree: tree
    }
});

//# sourceMappingURL=app-page.js.map

/***/ }),

/***/ 93011:
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 9550))

/***/ }),

/***/ 9550:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ Upload)
});

// EXTERNAL MODULE: external "next/dist/compiled/react/jsx-runtime"
var jsx_runtime_ = __webpack_require__(56786);
// EXTERNAL MODULE: ./components/ui/use-toast.ts
var use_toast = __webpack_require__(52270);
// EXTERNAL MODULE: ./node_modules/.pnpm/axios@1.6.2/node_modules/axios/lib/axios.js + 48 modules
var axios = __webpack_require__(2463);
// EXTERNAL MODULE: ./node_modules/.pnpm/react-hook-form@7.49.2_react@18.2.0/node_modules/react-hook-form/dist/index.esm.mjs
var index_esm = __webpack_require__(40788);
// EXTERNAL MODULE: external "next/dist/compiled/react"
var react_ = __webpack_require__(18038);
// EXTERNAL MODULE: ./components/constant.ts
var constant = __webpack_require__(96539);
// EXTERNAL MODULE: ./lib/client-helper.ts
var client_helper = __webpack_require__(55770);
;// CONCATENATED MODULE: ./components/image-upload/types.image.ts
const imageObj = {};
// Filter
const defaultFilter = {
    aspect: 16 / 9,
    size: 1,
    multiple: true,
    accept: [
        "jpeg",
        "png"
    ]
};

// EXTERNAL MODULE: ./node_modules/.pnpm/lucide-react@0.268.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/crop.js
var crop = __webpack_require__(1762);
// EXTERNAL MODULE: ./node_modules/.pnpm/lucide-react@0.268.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/more-vertical.js
var more_vertical = __webpack_require__(18166);
// EXTERNAL MODULE: ./node_modules/.pnpm/lucide-react@0.268.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/trash-2.js
var trash_2 = __webpack_require__(79747);
// EXTERNAL MODULE: ./components/ui/button.tsx
var ui_button = __webpack_require__(20559);
// EXTERNAL MODULE: ./node_modules/.pnpm/react-image-crop@11.0.1_react@18.2.0/node_modules/react-image-crop/dist/index.js
var dist = __webpack_require__(55709);
// EXTERNAL MODULE: ./node_modules/.pnpm/browser-image-compression@2.0.2/node_modules/browser-image-compression/dist/browser-image-compression.js
var browser_image_compression = __webpack_require__(66468);
var browser_image_compression_default = /*#__PURE__*/__webpack_require__.n(browser_image_compression);
// EXTERNAL MODULE: ./node_modules/.pnpm/react-image-crop@11.0.1_react@18.2.0/node_modules/react-image-crop/dist/ReactCrop.css
var ReactCrop = __webpack_require__(34534);
;// CONCATENATED MODULE: ./components/image-upload/canvasPreview.tsx
const TO_RADIANS = Math.PI / 180;
async function canvasPreview({ image, canvas, crop, scale = 1, rotate = 0 }) {
    if (!canvas || !image) {
        return false;
    }
    const ctx = canvas?.getContext("2d") || null;
    if (!canvas) return new Error("Canvas not found");
    if (!ctx) {
        return new Error("No 2d context");
    }
    const scaleX = image.naturalWidth / image.width;
    const scaleY = image.naturalHeight / image.height;
    // devicePixelRatio slightly increases sharpness on retina devices
    // at the expense of slightly slower render times and needing to
    // size the image back down if you want to download/upload and be
    // true to the images natural size.
    const pixelRatio = window.devicePixelRatio;
    // const pixelRatio = 1
    canvas.width = Math.floor(crop.width * scaleX);
    canvas.height = Math.floor(crop.height * scaleY);
    // ctx.scale(pixelRatio, pixelRatio);
    // ctx.imageSmoothingQuality = 'high';
    const cropX = crop.x * scaleX;
    const cropY = crop.y * scaleY;
    const rotateRads = rotate * TO_RADIANS;
    const centerX = image.naturalWidth / 2;
    const centerY = image.naturalHeight / 2;
    ctx.save();
    // 5) Move the crop origin to the canvas origin (0,0)
    ctx.translate(-cropX, -cropY);
    // 4) Move the origin to the center of the original position
    ctx.translate(centerX, centerY);
    // 3) Rotate around the origin
    ctx.rotate(rotateRads);
    // 2) Scale the image
    ctx.scale(scale, scale);
    // 1) Move the center of the image to the origin (0,0)
    ctx.translate(-centerX, -centerY);
    ctx.drawImage(image, 0, 0, image.naturalWidth, image.naturalHeight, 0, 0, image.naturalWidth, image.naturalHeight);
    ctx.restore();
    return true;
}

// EXTERNAL MODULE: ./components/ui/dialog.tsx
var dialog = __webpack_require__(59606);
// EXTERNAL MODULE: ./node_modules/.pnpm/lucide-react@0.268.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/refresh-ccw.js
var refresh_ccw = __webpack_require__(93164);
// EXTERNAL MODULE: ./node_modules/.pnpm/lucide-react@0.268.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/rotate-ccw.js
var rotate_ccw = __webpack_require__(42358);
// EXTERNAL MODULE: ./node_modules/.pnpm/lucide-react@0.268.0_react@18.2.0/node_modules/lucide-react/dist/esm/icons/rotate-cw.js
var rotate_cw = __webpack_require__(83607);
// EXTERNAL MODULE: ./lib/utils.ts
var utils = __webpack_require__(30178);
;// CONCATENATED MODULE: ./components/ui/input.tsx



const Input = /*#__PURE__*/ react_.forwardRef(({ className, type, ...props }, ref)=>{
    return /*#__PURE__*/ jsx_runtime_.jsx("input", {
        type: type,
        className: (0,utils.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50", className),
        ref: ref,
        ...props
    });
});
Input.displayName = "Input";


// EXTERNAL MODULE: ./node_modules/.pnpm/@radix-ui+react-slider@1.1.2_@types+react-dom@18.2.7_@types+react@18.2.20_react-dom@18.2.0_react@18.2.0/node_modules/@radix-ui/react-slider/dist/index.mjs + 2 modules
var react_slider_dist = __webpack_require__(49156);
;// CONCATENATED MODULE: ./components/ui/slider.tsx
/* __next_internal_client_entry_do_not_use__ Slider auto */ 



const Slider = /*#__PURE__*/ react_.forwardRef(({ className, ...props }, ref)=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)(react_slider_dist/* Root */.fC, {
        ref: ref,
        className: (0,utils.cn)("relative flex w-full touch-none select-none items-center", className),
        ...props,
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx(react_slider_dist/* Track */.fQ, {
                className: "relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",
                children: /*#__PURE__*/ jsx_runtime_.jsx(react_slider_dist/* Range */.e6, {
                    className: "absolute h-full bg-primary"
                })
            }),
            /*#__PURE__*/ jsx_runtime_.jsx(react_slider_dist/* Thumb */.bU, {
                className: "block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"
            })
        ]
    }));
Slider.displayName = react_slider_dist/* Root */.fC.displayName;


;// CONCATENATED MODULE: ./lib/hooks/useDebounceEffect.ts

function useDebounceEffect({ fn, waitTime, deps }) {
    (0,react_.useEffect)(()=>{
        const t = setTimeout(()=>{
            fn.apply(undefined, deps);
        }, waitTime);
        return ()=>{
            clearTimeout(t);
        };
    }, [
        deps,
        fn,
        waitTime
    ]);
}

;// CONCATENATED MODULE: ./components/image-upload/crop-dialog.tsx
/* __next_internal_client_entry_do_not_use__ default auto */ 















function centerAspectCrop({ mediaWidth, mediaHeight, aspect }) {
    // console.log('running centerAspectCrop');
    return (0,dist/* centerCrop */._H)((0,dist/* makeAspectCrop */.YG)({
        unit: "%",
        width: 100
    }, aspect || 16 / 9, mediaWidth, mediaHeight), mediaWidth, mediaHeight);
}
const imageHandW = {
    width: "30vh"
};
function CropDialog({ propAspect, propSize, onClose, previousImgSrc, prevName, autoOpen, customClass, customOpen }) {
    const [imgSrc, setImgSrc] = (0,react_.useState)();
    const [nameHere, setNameHere] = (0,react_.useState)("");
    const previewCanvasRef = (0,react_.useRef)(null);
    const imgRef = (0,react_.useRef)(null);
    const changePhotoRef = (0,react_.useRef)(null);
    const [crop, setCrop] = (0,react_.useState)();
    const [completedCrop, setCompletedCrop] = (0,react_.useState)();
    const [scale, setScale] = (0,react_.useState)(1);
    const [rotate, setRotate] = (0,react_.useState)(0);
    const [aspect, setAspect] = (0,react_.useState)(0);
    const [openModal, setOpenModal] = (0,react_.useState)(false);
    (0,react_.useEffect)(()=>{
        if (openModal) {
            setRotate(0);
            if (propAspect) {
                setAspect(propAspect);
            }
            if (previousImgSrc) {
                setImgSrc(previousImgSrc);
                openAgain(previousImgSrc);
            }
            if (prevName) {
                setNameHere(prevName);
            }
        }
    }, [
        openModal,
        previousImgSrc,
        prevName,
        propAspect
    ]);
    (0,react_.useEffect)(()=>{
        if (autoOpen) {
            handleOpenModal();
        }
    }, [
        autoOpen
    ]);
    const onCloseHere = (0,react_.useCallback)(()=>{
        setImgSrc(undefined);
        setCompletedCrop(undefined);
        setOpenModal(false);
        onClose();
    }, [
        onClose
    ]);
    (0,react_.useEffect)(()=>{
        if (customOpen || customOpen === false) {
            if (customOpen) {
                handleOpenModal();
            } else {
                onCloseHere();
            }
        }
    }, [
        customOpen,
        onCloseHere
    ]);
    const openAgain = async (previousImgSrc)=>{
        if (!(previousImgSrc instanceof Blob)) return;
        setCrop(undefined); // Makes crop preview update between images.
        const base64 = await (0,client_helper/* blobToPreview */.Dl)(previousImgSrc);
        if (!base64) {
            (0,use_toast/* toast */.Am)({
                variant: "destructive",
                title: "blobToPreview did not return url"
            });
            return;
        }
        setImgSrc(base64);
    };
    function handleOpenModal() {
        setOpenModal(true);
    }
    const readBlob = (0,react_.useCallback)((file)=>new Promise((resolve, reject)=>{
            const readerBlob = new FileReader();
            readerBlob.onabort = ()=>{
                reject(new Error(`file reading was aborted `));
            };
            readerBlob.onerror = ()=>{
                reject(new Error(`file reading has failed `));
            };
            readerBlob.onload = ()=>{
                if (file?.size > Number(propSize) * 1048576) {
                    // propSize in MB
                    reject(new Error(`Image size is more than ${propSize}mb of ${file.name}`));
                }
                if (!readerBlob.result) {
                    (0,use_toast/* toast */.Am)({
                        variant: "destructive",
                        title: "readerBlob.result is null"
                    });
                    return;
                }
                const blob = new Blob([
                    readerBlob.result
                ], {
                    type: file.type
                });
                resolve(blob);
                return true;
            };
            readerBlob.readAsArrayBuffer(file);
        }), [
        propSize
    ]);
    const readBase64 = (0,react_.useCallback)((file)=>new Promise((resolve, reject)=>{
            const readerURL = new FileReader();
            readerURL.onabort = ()=>reject(new Error(`file reading was aborted `));
            readerURL.onerror = ()=>reject(new Error(`file reading has failed `));
            readerURL.onload = ()=>{
                const display = readerURL.result;
                if (!display) {
                    reject(new Error(`file result not found`));
                    return;
                }
                resolve(display);
                return true;
            };
            readerURL.readAsDataURL(file);
        }), []);
    async function onSelectFile(e) {
        try {
            if (e.target && e.target.files && e.target.files.length > 0) {
                const file = e.target.files[0];
                const [blob, base64] = await Promise.all([
                    readBlob(file),
                    readBase64(file)
                ]);
                setCrop(undefined); // Makes crop preview update between images.
                setImgSrc(base64 || undefined);
            }
            return true;
        } catch (err) {
            (0,use_toast/* toast */.Am)({
                variant: "destructive",
                title: err.message
            });
            return null;
        }
    }
    const onImageLoad = (0,react_.useCallback)((e)=>{
        if (e.currentTarget && imgRef) {
            const { width, height } = e.currentTarget;
            if (width && height) {
                setCrop(centerAspectCrop({
                    mediaWidth: width,
                    mediaHeight: height,
                    aspect
                }));
            }
            if (!imgRef || !imgRef.current || !previewCanvasRef.current || !completedCrop) {
                return false;
            }
            canvasPreview({
                image: imgRef.current,
                canvas: previewCanvasRef.current,
                crop: completedCrop,
                scale,
                rotate
            });
        }
    }, [
        completedCrop,
        scale,
        rotate,
        aspect
    ]);
    async function onSubmitHere() {
        if (!previewCanvasRef) {
            return false;
        }
        if (!previewCanvasRef?.current) {
            (0,use_toast/* toast */.Am)({
                variant: "destructive",
                title: `Please Update/Crop Image`
            });
            return false;
        }
        if (!previewCanvasRef?.current?.toDataURL()) {
            (0,use_toast/* toast */.Am)({
                variant: "destructive",
                title: `Please Update/Crop Image`
            });
            return false;
        }
        if (previewCanvasRef?.current && previewCanvasRef?.current?.toDataURL()) {
            const blobData = await getblob(previewCanvasRef);
            // const toastID = toast.loading('Processing...');
            // console.log('Before Compression', e.target.files[0]?.size);
            const options = {
                maxSizeMB: propSize
            };
            const toOptimiseFile = blobToFile(blobData, "");
            const compressedBlob = await browser_image_compression_default()(toOptimiseFile, options);
            // console.log('After Compression', compressedFile);
            // customToast({ updateId: toastID, type: 'update', msg: 'Image Processed', updateType: 'success' });
            onClose(compressedBlob, nameHere);
        } else {
            onClose();
        }
        setImgSrc(undefined);
        setCompletedCrop(undefined);
        setOpenModal(false);
        return true;
    }
    function blobToFile(blob, fileName) {
        // Create a new File instance using the Blob data and a specified filename
        return new File([
            blob
        ], fileName, {
            type: blob.type
        });
    }
    const getblob = (previewCanvasRef)=>new Promise((resolve, reject)=>{
            const canvas = previewCanvasRef?.current;
            if (!canvas) {
                reject(new Error(`Canvas not found`));
                return;
            }
            const ctx = canvas.getContext("2d");
            if (!ctx) {
                reject(new Error(`ctx not found`));
                return;
            }
            const img = new Image();
            img.src = previewCanvasRef?.current.toDataURL();
            img.onload = ()=>{
                canvas.width = img.width;
                canvas.height = img.height;
                ctx.drawImage(img, 0, 0);
                // Get the Blob
                canvas.toBlob((blob)=>{
                    // You can use the retrieved blob here
                    if (blob) {
                        resolve(blob);
                    } else {
                        reject(new Error(`Blob is null`));
                    }
                });
            };
        });
    useDebounceEffect({
        fn: async ()=>{
            if (completedCrop?.width && completedCrop?.height && imgRef.current && previewCanvasRef.current) {
                canvasPreview({
                    image: imgRef.current,
                    canvas: previewCanvasRef.current,
                    crop: completedCrop,
                    scale,
                    rotate
                });
            }
        },
        waitTime: 100,
        deps: [
            completedCrop,
            scale,
            rotate
        ]
    });
    const clickChangePhoto = ()=>{
        if (!changePhotoRef) return;
        const isThere = changePhotoRef?.current;
        if (!isThere) {
            return;
        }
        isThere.click();
    };
    const ConditionalRender = (0,react_.useCallback)(()=>{
        if (imgSrc && imgSrc instanceof Blob) return;
        const newImgSrc = imgSrc;
        if (!newImgSrc) return;
        return /*#__PURE__*/ jsx_runtime_.jsx("img", {
            crossOrigin: "anonymous",
            ref: imgRef,
            alt: "Crop me",
            src: newImgSrc,
            // width={400}
            // // sizes='100vw'
            // height={400}
            style: {
                transform: `scale(${scale}) rotate(${rotate}deg)`
            },
            onLoad: onImageLoad
        });
    }, [
        imgSrc,
        imgRef,
        scale,
        rotate
    ]);
    return /*#__PURE__*/ jsx_runtime_.jsx(jsx_runtime_.Fragment, {
        children: /*#__PURE__*/ jsx_runtime_.jsx(dialog/* Dialog */.Vq, {
            open: openModal,
            onOpenChange: onCloseHere,
            children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)(dialog/* DialogContent */.cZ, {
                className: "md:max-w-[800px]",
                children: [
                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)(dialog/* DialogHeader */.fK, {
                        children: [
                            /*#__PURE__*/ jsx_runtime_.jsx(dialog/* DialogTitle */.$N, {
                                className: "mb-4",
                                children: "Crop Image"
                            }),
                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)(dialog/* DialogDescription */.Be, {
                                children: [
                                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                        className: "gap-4 overflow-hidden grid md:grid-cols-2 grid-cols-1 ",
                                        children: [
                                            !!imgSrc && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                className: "mx-auto ",
                                                children: [
                                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                                        children: "Your Image"
                                                    }),
                                                    /*#__PURE__*/ jsx_runtime_.jsx(dist/* default */.ZP, {
                                                        crop: crop,
                                                        onChange: (_, percentCrop)=>setCrop(percentCrop),
                                                        onComplete: (c)=>{
                                                            setCompletedCrop(c);
                                                        },
                                                        aspect: aspect,
                                                        style: {
                                                            ...imageHandW
                                                        },
                                                        children: /*#__PURE__*/ jsx_runtime_.jsx(ConditionalRender, {})
                                                    })
                                                ]
                                            }),
                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                className: "mx-auto hidden sm:block ",
                                                children: [
                                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                                        children: "Output Image"
                                                    }),
                                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                                        className: "h-full my-auto flex items-center",
                                                        children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                                            style: {
                                                                ...imageHandW
                                                            },
                                                            children: !!completedCrop && /*#__PURE__*/ jsx_runtime_.jsx("canvas", {
                                                                ref: previewCanvasRef,
                                                                style: {
                                                                    border: "1px solid black",
                                                                    objectFit: "contain",
                                                                    width: "100%",
                                                                    height: "100%"
                                                                }
                                                            })
                                                        })
                                                    })
                                                ]
                                            }),
                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                className: "",
                                                children: [
                                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                                        className: "text-center mb-3",
                                                        children: "Rotate"
                                                    }),
                                                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                        className: " flex justify-center",
                                                        children: [
                                                            /*#__PURE__*/ jsx_runtime_.jsx(ui_button/* Button */.z, {
                                                                variant: "secondary",
                                                                type: "button",
                                                                className: "px-3 me-2 rounded-pill",
                                                                onClick: (e)=>setRotate(Number(rotate + 90)),
                                                                children: /*#__PURE__*/ jsx_runtime_.jsx(rotate_cw/* default */.Z, {})
                                                            }),
                                                            /*#__PURE__*/ jsx_runtime_.jsx(ui_button/* Button */.z, {
                                                                variant: "secondary",
                                                                type: "button",
                                                                onClick: (e)=>setRotate(Number(rotate - 90)),
                                                                className: "px-3 rounded-pill",
                                                                children: /*#__PURE__*/ jsx_runtime_.jsx(rotate_ccw/* default */.Z, {})
                                                            })
                                                        ]
                                                    })
                                                ]
                                            }),
                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                className: "hidden",
                                                children: [
                                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                                        className: "text-center mb-3",
                                                        children: "Zoom"
                                                    }),
                                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                                        className: " flex justify-center",
                                                        children: /*#__PURE__*/ jsx_runtime_.jsx(Slider, {
                                                            defaultValue: [
                                                                40
                                                            ],
                                                            onValueChange: (e)=>{
                                                                setCrop((prev)=>{
                                                                    if (!prev) return {};
                                                                    console.log({
                                                                        e,
                                                                        propAspect,
                                                                        prev
                                                                    });
                                                                    const newWidth = Number(e[0]);
                                                                    const newHeight = newWidth / propAspect;
                                                                    // const newReturn = {
                                                                    // 	...prev,
                                                                    // 	width: newWidth,
                                                                    // 	height: newHeight,
                                                                    // };
                                                                    const newResult = centerAspectCrop({
                                                                        mediaWidth: newWidth,
                                                                        mediaHeight: newHeight,
                                                                        aspect: propAspect
                                                                    });
                                                                    console.log({
                                                                        newResult
                                                                    });
                                                                    return newResult;
                                                                });
                                                            },
                                                            name: "logoWidth",
                                                            id: "logoWidth",
                                                            max: 100,
                                                            min: 1,
                                                            step: 1
                                                        })
                                                    })
                                                ]
                                            })
                                        ]
                                    }),
                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                        children: /*#__PURE__*/ jsx_runtime_.jsx(Input, {
                                            type: "file",
                                            className: "hidden",
                                            ref: changePhotoRef,
                                            onChange: (e)=>onSelectFile(e),
                                            accept: "image/*"
                                        })
                                    })
                                ]
                            })
                        ]
                    }),
                    /*#__PURE__*/ jsx_runtime_.jsx(dialog/* DialogFooter */.cN, {
                        children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                            className: "flex justify-end items-center w-100 flex-col md:flex-row gap-3",
                            children: [
                                /*#__PURE__*/ (0,jsx_runtime_.jsxs)(ui_button/* Button */.z, {
                                    type: "button",
                                    onClick: ()=>clickChangePhoto(),
                                    // disabled={isLoading}
                                    variant: "outline",
                                    className: "rounded-pill px-3 px-md-4 me-3 w-[200px]",
                                    children: [
                                        /*#__PURE__*/ jsx_runtime_.jsx(refresh_ccw/* default */.Z, {
                                            size: 16,
                                            className: "me-2"
                                        }),
                                        " Change Photo"
                                    ]
                                }),
                                /*#__PURE__*/ jsx_runtime_.jsx(ui_button/* Button */.z, {
                                    type: "button",
                                    // disabled={isLoading}
                                    onClick: ()=>onSubmitHere(),
                                    variant: "default",
                                    className: "rounded-pill px-3 px-md-4 w-100 w-[130px]",
                                    children: "Apply"
                                })
                            ]
                        })
                    })
                ]
            })
        })
    });
}

// EXTERNAL MODULE: ./node_modules/.pnpm/next@13.4.19_react-dom@18.2.0_react@18.2.0/node_modules/next/image.js
var next_image = __webpack_require__(3719);
var image_default = /*#__PURE__*/__webpack_require__.n(next_image);
// EXTERNAL MODULE: ./components/ui/popover.tsx
var popover = __webpack_require__(33178);
// EXTERNAL MODULE: ./node_modules/.pnpm/@radix-ui+react-popover@1.0.7_@types+react-dom@18.2.7_@types+react@18.2.20_react-dom@18.2.0_react@18.2.0/node_modules/@radix-ui/react-popover/dist/index.mjs + 1 modules
var react_popover_dist = __webpack_require__(71980);
// EXTERNAL MODULE: ./node_modules/.pnpm/react-dropzone@14.2.3_react@18.2.0/node_modules/react-dropzone/dist/index.js
var react_dropzone_dist = __webpack_require__(53413);
;// CONCATENATED MODULE: ./components/image-upload/drop-zone.tsx
/* __next_internal_client_entry_do_not_use__ default auto */ 


// import * as _ from 'lodash';
// import customToast from '../../utils/customToast';
// import ImageUpload from './crop-dialog';



const DropZone = ({ onClose, propSize = 1, propAspect, acceptType = [
    "jpeg",
    "png"
], multiple = false, className, ...other })=>{
    const [fileState, setFileState] = (0,react_.useState)([]);
    const [acceptTypeState, setAcceptTypeState] = (0,react_.useState)(acceptType);
    (0,react_.useEffect)(()=>{
        setAcceptTypeState(acceptType);
    }, [
        acceptType
    ]);
    const readBlob = (0,react_.useCallback)((file, index)=>new Promise((resolve, reject)=>{
            const readerBlob = new FileReader();
            readerBlob.onabort = ()=>{
                reject(new Error(`file reading was aborted index - ${index}`));
            };
            readerBlob.onerror = ()=>{
                reject(new Error(`file reading has failed index - ${index}`));
            };
            readerBlob.onload = ()=>{
                if (!readerBlob || !readerBlob.result) {
                    return;
                }
                if (file?.size > Number(propSize) * 1048576) {
                    // propSize in MB
                    reject(new Error(`Image size is more than ${propSize}mb of ${file.name}`));
                }
                const blob = new Blob([
                    readerBlob.result
                ], {
                    type: file.type
                });
                resolve(blob);
                return true;
            };
            readerBlob.readAsArrayBuffer(file);
        }), [
        propSize
    ]);
    const readBase64 = (0,react_.useCallback)((file, index)=>new Promise((resolve, reject)=>{
            const readerURL = new FileReader();
            readerURL.onabort = ()=>reject(new Error(`file reading was aborted index -${index}`));
            readerURL.onerror = ()=>reject(new Error(`file reading has failed index -${index}`));
            readerURL.onload = ()=>{
                const display = readerURL.result;
                resolve(display);
                return true;
            };
            readerURL.readAsDataURL(file);
        }), []);
    const onDrop = (0,react_.useCallback)(async (acceptedFiles)=>{
        const readSingleFile = async (file, index)=>{
            try {
                const [resultBlob, resultBase64] = await Promise.all([
                    readBlob(file, index),
                    readBase64(file, index)
                ]);
                const result = {
                    blob: resultBlob,
                    display: resultBase64,
                    name: file.name,
                    size: file.size,
                    type: file.type
                };
                return result;
            } catch (err) {
                (0,use_toast/* toast */.Am)({
                    variant: "destructive",
                    title: err?.message
                });
                return undefined;
            // return new Error(err?.message || err);
            }
        };
        try {
            const iteratorTo = multiple ? acceptedFiles.length : 1;
            let allFilesResult = new Array(iteratorTo).fill(0)?.map((_)=>imageObj);
            for(let index = 0; index < iteratorTo; index += 1){
                // eslint-disable-next-line no-await-in-loop
                const resultHere = await readSingleFile(acceptedFiles[index], index);
                if (!resultHere) {}
                allFilesResult[index] = resultHere;
            }
            allFilesResult = allFilesResult.filter((i)=>i);
            // if (multiple) {
            onClose(allFilesResult);
            // } else {
            //   setFileState(allFilesResult);
            // }
            return true;
        } catch (err2) {
            console.log(err2);
            return false;
        }
    }, [
        readBase64,
        readBlob,
        multiple,
        onClose
    ]);
    const getCroppedHere = async (preview = "")=>{
        if (!preview) return false;
        const blob = await (0,client_helper/* previewToBlob */.Ad)(preview);
        if (!blob) {
            return false;
        }
        const updateFields = {
            display: preview,
            blob,
            size: blob.size
        };
        setFileState((prev)=>[
                {
                    ...prev[0],
                    ...updateFields
                }
            ]);
        onClose([
            {
                ...fileState,
                ...updateFields
            }
        ]);
        return true;
    };
    const acceptData = (0,react_.useMemo)(()=>{
        const returnArr = [];
        const checkThis = acceptTypeState || [];
        if (checkThis.indexOf("jpeg") !== -1) {
            returnArr.push("image/jpeg");
            returnArr.push("image/jpg");
        }
        if (checkThis.indexOf("png") !== -1) {
            returnArr.push("image/png");
        }
        if (checkThis.indexOf("gif") !== -1) {
            returnArr.push("image/gif");
        }
        const returnName = returnArr.join(",");
        return returnName;
    }, [
        acceptTypeState
    ]);
    const acceptInfo = (0,react_.useMemo)(()=>{
        const returnArr = [];
        const checkThis = acceptTypeState || [];
        if (checkThis.indexOf("jpeg") !== -1) {
            returnArr.push("JPEG");
        }
        if (checkThis.indexOf("png") !== -1) {
            returnArr.push("PNG");
        }
        if (checkThis.indexOf("gif") !== -1) {
            returnArr.push("GIF");
        }
        const returnName = returnArr.join(" or ");
        return returnName;
    }, [
        acceptTypeState
    ]);
    const dropZoneAccept = (0,react_.useMemo)(()=>{
        const returnArr = [];
        const checkThis = acceptTypeState || [];
        if (checkThis.indexOf("jpeg") !== -1) {
            returnArr.push("image/jpeg");
            returnArr.push("image/jpg");
        }
        if (checkThis.indexOf("png") !== -1) {
            returnArr.push("image/png");
        }
        if (checkThis.indexOf("gif") !== -1) {
            returnArr.push("image/gif");
        }
        const obj = {};
        for (const mimeType of returnArr){
            obj[mimeType] = [];
        }
        return obj;
    }, [
        acceptTypeState
    ]);
    const { getRootProps, getInputProps, isDragActive } = (0,react_dropzone_dist.useDropzone)({
        onDrop,
        accept: dropZoneAccept
    });
    return /*#__PURE__*/ jsx_runtime_.jsx(jsx_runtime_.Fragment, {
        children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
            ...getRootProps(),
            style: {
                minHeight: "150px",
                maxHeight: "300px",
                border: "2px dashed grey",
                borderRadius: "12px",
                padding: 2
            },
            className: `text-sm flex flex-col justify-center items-center cursor-pointer flex-column bg-secondary ${className}`,
            children: [
                /*#__PURE__*/ jsx_runtime_.jsx("input", {
                    ...getInputProps(),
                    accept: acceptData,
                    multiple: multiple
                }),
                /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: "font-bold",
                    children: isDragActive ? /*#__PURE__*/ jsx_runtime_.jsx("p", {
                        children: "Drop your file here..."
                    }) : /*#__PURE__*/ (0,jsx_runtime_.jsxs)("p", {
                        children: [
                            "Drag and drop or ",
                            /*#__PURE__*/ jsx_runtime_.jsx("b", {
                                children: "choose"
                            }),
                            " a file to upload"
                        ]
                    })
                }),
                /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: "mt-4",
                    children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("ul", {
                        className: "md:list-disc ",
                        children: [
                            multiple === true && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("li", {
                                children: [
                                    "You can upload ",
                                    /*#__PURE__*/ jsx_runtime_.jsx("b", {
                                        children: "multiple"
                                    }),
                                    " pictures"
                                ]
                            }),
                            propSize && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("li", {
                                className: "text-destructive ",
                                children: [
                                    "Max size of the image should be ",
                                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("b", {
                                        children: [
                                            propSize,
                                            " MB"
                                        ]
                                    })
                                ]
                            }),
                            !!propAspect && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("li", {
                                className: "text-destructive ",
                                children: [
                                    "Dimension will be",
                                    " ",
                                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("b", {
                                        children: [
                                            propAspect === 16 / 9 ? "16:9" : "1:1",
                                            " (",
                                            acceptInfo,
                                            ")"
                                        ]
                                    })
                                ]
                            })
                        ]
                    })
                })
            ]
        })
    });
};
/* harmony default export */ const drop_zone = (DropZone);

;// CONCATENATED MODULE: ./lib/hooks/useUploadImg.ts



function useUploadImageToS3() {
    // UPLOAD Image to S3 ==========================
    // url: the api that should be called
    // headers:
    // sendData:
    // YOU SHOULD SEND ONE OF value OR body
    // value: This is image link
    // body: This is the blob body
    const uploadImageToS3 = async ({ url: apiUrl, sendData, value, headers, body: parentBody })=>{
        if (!!parentBody && !!value) {
            throw new Error("Blob or URL is required !!!");
        }
        // eventRef, userID, currentFileName, ext, type
        const res = await axios/* default */.Z.post(apiUrl, sendData, headers);
        if (!res || !res?.data?.ok) {
            throw new Error(res?.data?.errors[0]?.message || constant/* defaultError */.io);
        }
        const dataHere = res?.data?.packet?.s3Data;
        let returnLink = "";
        const body = parentBody || value && await (0,client_helper/* getBlob */.Br)(value);
        if (!body || body instanceof Error) throw new Error("Image is not valid !!!");
        if (!dataHere) {
            throw new Error(constant/* defaultError */.io);
        }
        let status;
        const url = dataHere?.url;
        const checkLink = dataHere?.source;
        console.log("send uploadImageAndCheck", url, body, checkLink);
        status = await uploadImageAndCheck({
            url,
            body,
            checkLink,
            headers
        });
        if (status) returnLink = checkLink;
        else {
            status = await uploadImageAndCheck({
                url,
                body,
                checkLink,
                headers
            });
            if (status) returnLink = checkLink;
            else {
                status = await uploadImageAndCheck({
                    url,
                    body,
                    checkLink,
                    headers
                });
                if (status) returnLink = checkLink;
                else throw new Error("Error in uploading the image");
            }
        }
        return returnLink;
    };
    // Image check if it is really there or not
    const uploadImageAndCheck = async ({ url, body, checkLink, headers = {} })=>{
        const res1 = await axios/* default */.Z.put(url, body, {
            headers
        });
        if (!res1) return false;
        const res2 = await fetch(`${constant/* S3BucketBaseUrl */.aN}${checkLink}`);
        if (res2.status === 200) return true;
        return false;
    };
    return {
        uploadImageToS3
    };
}
/* harmony default export */ const useUploadImg = (useUploadImageToS3);

;// CONCATENATED MODULE: ./app/(preview)/upload/page.tsx
/* __next_internal_client_entry_do_not_use__ default auto */ 

















const filter = {
    multiple: true,
    size: 5,
    aspect: 0,
    accept: [
        "png",
        "jpeg"
    ]
};
function Upload() {
    const { toast } = (0,use_toast/* useToast */.pm)();
    const { register, watch, handleSubmit, setValue, getValues, formState: { errors }, reset } = (0,index_esm/* useForm */.cI)();
    const { uploadImageToS3 } = useUploadImg();
    const [currentState, setCurrentState] = (0,react_.useState)("true");
    const [eventRef, setEventRef] = (0,react_.useState)("");
    const [eventList, setEventList] = (0,react_.useState)([]);
    const [imagesHere, setImageHere] = (0,react_.useState)([]);
    const [editImg, setEditImg] = (0,react_.useState)({
        index: undefined,
        display: "",
        blob: new Blob(),
        name: "",
        size: 0,
        type: ""
    });
    const getEventList = (0,react_.useCallback)(async ()=>{
        try {
            setCurrentState("loading");
            const packet = await axios/* default */.Z.get("/api/event");
            if (!packet?.data?.ok) {
                toast({
                    variant: "destructive",
                    title: packet?.data?.errors?.[0]?.message
                });
                return false;
            }
            setEventList(packet?.data?.packet?.list);
            return true;
        } catch (err) {
            const errMsg = err?.response?.data?.errors?.[0]?.message;
            console.error(errMsg);
            toast({
                variant: "destructive",
                title: errMsg || "Something went wrong"
            });
            return false;
        } finally{
            setCurrentState("true");
        }
    }, []);
    (0,react_.useEffect)(()=>{
        getEventList();
    }, [
        getEventList
    ]);
    const formSubmit = async (data)=>{
        setCurrentState("loading");
        let errMsg = "";
        if (!data.source) errMsg = "Image is requried";
        if (!data.caption) errMsg = "Caption is requried";
        if (!data.eventRef) errMsg = "Event is requried";
        if (errMsg) {
            toast({
                variant: "destructive",
                title: errMsg
            });
            return false;
        }
        toast({
            description: errMsg,
            variant: "destructive"
        });
        const sendData = data;
        try {
            const packet = await axios/* default */.Z.post("/api/post", sendData);
            if (!packet?.data?.ok) {
                toast({
                    variant: "destructive",
                    title: packet?.data?.errors?.[0]?.message
                });
                return false;
            }
            toast({
                description: "Successfully uploaded the photo"
            });
            return true;
        } catch (err) {
            const errMsg = err?.response?.data?.errors?.[0]?.message;
            console.error(errMsg);
            toast({
                variant: "destructive",
                title: errMsg
            });
            return false;
        } finally{
            setCurrentState("true");
        }
    };
    const onCloseImage = (0,react_.useCallback)((dataArr)=>{
        if (!dataArr) return false;
        if (filter.multiple) {
            setImageHere((prev)=>[
                    ...prev,
                    ...dataArr
                ]);
        } else {
            setImageHere(dataArr);
        }
        if (!filter.multiple && dataArr.length > 0) {
            setEditImg({
                index: 0,
                ...dataArr[0]
            });
        }
        return true;
    }, []);
    const editHandle = async (index = 0)=>{
        const editThis = imagesHere[index];
        if (editThis?.blob) {
            setEditImg({
                ...editThis,
                index
            });
        } else if (editThis?.display) {
            const blob = await (0,client_helper/* previewToBlob */.Ad)(editThis.display);
            if (!blob) return;
            setEditImg({
                ...editThis,
                index,
                blob,
                size: blob.size
            });
        }
    };
    const closeSingleEdit = (0,react_.useCallback)(async (blob, name)=>{
        const changeIndex = editImg.index || 0;
        if (changeIndex < 0) return;
        if (!blob) {
            setEditImg({
                index: undefined,
                ...imageObj
            });
            return;
        }
        const preview = await (0,client_helper/* blobToPreview */.Dl)(blob);
        const updateFields = {
            display: preview,
            blob,
            size: blob.size,
            name
        };
        setImageHere((prev)=>prev.map((i, index)=>{
                if (index !== changeIndex) {
                    return i;
                }
                return {
                    ...i,
                    ...updateFields
                };
            }));
        setEditImg({
            index: undefined,
            ...imageObj
        });
    }, [
        editImg.index
    ]);
    const clearImage = (index)=>{
        if (index !== undefined && index > -1) {
            setImageHere((prev)=>[
                    ...prev.slice(0, index),
                    ...prev.slice(index + 1)
                ]);
            return true;
        }
        setImageHere([]);
        return true;
    };
    const executeUpload = async ()=>{
        try {
            for (let img of imagesHere){
                const imgSrc = await getPresigned(img);
                console.log("executeUpload result ", imgSrc);
                await formSubmit({
                    source: imgSrc,
                    caption: getValues("caption"),
                    eventRef: getValues("eventRef")
                });
            }
        } catch (err) {
            toast({
                variant: "destructive",
                title: err?.message || constant/* defaultError */.io
            });
        } finally{
            reset();
            clearImage();
        }
    };
    const getPresigned = async (img)=>{
        const imgData = img;
        const imgSrc = await uploadImageToS3({
            url: "/api/post/action/presigned-url",
            sendData: {
                currentFileName: imgData?.name?.split("/")?.pop() || "",
                ext: imgData?.type.split("/")[1],
                type: "post"
            },
            body: imgData?.blob,
            headers: {
                "Content-Type": imgData.blob.type
            }
        });
        return imgSrc;
    // const sendData = { ext: 'png', type: 'post' };
    // try {
    // 	const packet = await axios.post('/api/post/action/presigned-url', sendData);
    // 	if (!packet?.data?.ok) {
    // 		toast({ variant: 'destructive', title: packet?.data?.errors?.[0]?.message });
    // 		return false;
    // 	}
    // 	// 	"packet": {
    // 	//     "s3Data": {
    // 	//         "url": "https://tanish-app.s3.ap-south-1.amazonaws.com/post/qZwaUFdLI2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAYPKAVF2HRZE4JQPX%2F20231228%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20231228T054259Z&X-Amz-Expires=300&X-Amz-Signature=e93174aff69510e9c7570cbac9e9e459bd4b944054776bf8746d17a6ccd275ab&X-Amz-SignedHeaders=host&x-id=PutObject",
    // 	//         "source": "post/qZwaUFdLI2.png"
    // 	//     }
    // 	// }
    // 	return packet?.data?.s3Data;
    // } catch (err: any) {
    // 	const errMsg = err?.response?.data?.errors?.[0]?.message;
    // 	console.error(errMsg);
    // 	toast({ variant: 'destructive', title: errMsg });
    // 	return false;
    // }
    };
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "grid gap-4 ",
        children: [
            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "container",
                children: [
                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                        className: "flex justify-between my-6",
                        children: /*#__PURE__*/ jsx_runtime_.jsx("h4", {
                            className: "font-bold text-2xl",
                            children: "Upload"
                        })
                    }),
                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("form", {
                        className: "grid gap-10",
                        children: [
                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                className: "relative",
                                children: [
                                    /*#__PURE__*/ jsx_runtime_.jsx(drop_zone, {
                                        multiple: filter.multiple,
                                        onClose: onCloseImage,
                                        propSize: filter.size,
                                        acceptType: filter.accept,
                                        propAspect: filter.aspect
                                    }),
                                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                        className: "grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-10 ",
                                        children: imagesHere.length !== 0 && imagesHere.map((item, index)=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                className: "mb-3 border bg-secondary rounded-xl shadow-md relative overflow-hidden",
                                                children: [
                                                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                        className: "p-3",
                                                        children: [
                                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                                className: "pe-8",
                                                                children: [
                                                                    /*#__PURE__*/ jsx_runtime_.jsx("b", {
                                                                        children: "Name"
                                                                    }),
                                                                    " ",
                                                                    item.name
                                                                ]
                                                            }),
                                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                                children: [
                                                                    /*#__PURE__*/ jsx_runtime_.jsx("b", {
                                                                        children: "Type"
                                                                    }),
                                                                    " ",
                                                                    item.type
                                                                ]
                                                            }),
                                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                                children: [
                                                                    /*#__PURE__*/ jsx_runtime_.jsx("b", {
                                                                        children: "Size"
                                                                    }),
                                                                    " ",
                                                                    item.size,
                                                                    " (",
                                                                    (item.size / 1024).toFixed(1),
                                                                    " kb)"
                                                                ]
                                                            })
                                                        ]
                                                    }),
                                                    /*#__PURE__*/ jsx_runtime_.jsx((image_default()), {
                                                        src: item.display,
                                                        alt: item.name,
                                                        width: 80,
                                                        height: 50,
                                                        className: "w-full"
                                                    }),
                                                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)(popover/* Popover */.J2, {
                                                        children: [
                                                            /*#__PURE__*/ jsx_runtime_.jsx(react_popover_dist/* PopoverTrigger */.xo, {
                                                                className: "absolute top-2 right-2 p-2 shadow-md bg-[hsl(var(--background))] rounded-lg",
                                                                children: /*#__PURE__*/ jsx_runtime_.jsx(more_vertical/* default */.Z, {})
                                                            }),
                                                            /*#__PURE__*/ jsx_runtime_.jsx(react_popover_dist/* PopoverContent */.yk, {
                                                                className: "duration-500 animate-in text-[hsl(var(--foreground))]",
                                                                children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                                    className: "flex flex-col",
                                                                    children: [
                                                                        /*#__PURE__*/ (0,jsx_runtime_.jsxs)(ui_button/* Button */.z, {
                                                                            variant: "outline",
                                                                            type: "button",
                                                                            disabled: currentState === "loading",
                                                                            onClick: ()=>editHandle(index),
                                                                            className: "flex justify-between w-[110px] bg-[hsl(var(--background))]",
                                                                            children: [
                                                                                /*#__PURE__*/ jsx_runtime_.jsx(crop/* default */.Z, {
                                                                                    color: "blue"
                                                                                }),
                                                                                /*#__PURE__*/ jsx_runtime_.jsx("span", {
                                                                                    className: "",
                                                                                    children: "Crop "
                                                                                })
                                                                            ]
                                                                        }),
                                                                        /*#__PURE__*/ (0,jsx_runtime_.jsxs)(ui_button/* Button */.z, {
                                                                            disabled: currentState === "loading",
                                                                            variant: "outline",
                                                                            type: "button",
                                                                            onClick: ()=>clearImage(index),
                                                                            className: "flex justify-between w-[110px] bg-[hsl(var(--background))]",
                                                                            children: [
                                                                                /*#__PURE__*/ jsx_runtime_.jsx(trash_2/* default */.Z, {
                                                                                    color: "red"
                                                                                }),
                                                                                /*#__PURE__*/ jsx_runtime_.jsx("span", {
                                                                                    className: "",
                                                                                    children: "Delete "
                                                                                })
                                                                            ]
                                                                        })
                                                                    ]
                                                                })
                                                            })
                                                        ]
                                                    })
                                                ]
                                            }, index))
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                className: "relative",
                                children: [
                                    /*#__PURE__*/ jsx_runtime_.jsx("input", {
                                        ...register("caption", {
                                            required: true
                                        }),
                                        type: "textarea",
                                        placeholder: "Caption",
                                        className: constant/* inputStyle */.hG
                                    }),
                                    /*#__PURE__*/ jsx_runtime_.jsx("label", {
                                        className: constant/* labelStyle */.yI,
                                        children: "Caption"
                                    }),
                                    errors.name && /*#__PURE__*/ jsx_runtime_.jsx("p", {
                                        className: "text-destructive",
                                        children: "Caption is required."
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                className: "relative",
                                children: [
                                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("select", {
                                        ...register("eventRef"),
                                        className: constant/* inputStyle */.hG,
                                        placeholder: "Photo belong to event",
                                        children: [
                                            /*#__PURE__*/ jsx_runtime_.jsx("option", {
                                                value: "",
                                                children: "Select"
                                            }),
                                            eventList?.length > 0 && eventList?.map((i)=>/*#__PURE__*/ jsx_runtime_.jsx("option", {
                                                    value: i?._id,
                                                    children: i?.name
                                                }, i?._id))
                                        ]
                                    }),
                                    /*#__PURE__*/ jsx_runtime_.jsx("label", {
                                        className: constant/* labelStyle */.yI,
                                        children: "Photo belong to event"
                                    })
                                ]
                            }),
                            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                className: "flex justify-center",
                                children: /*#__PURE__*/ jsx_runtime_.jsx("button", {
                                    disabled: currentState === "loading",
                                    type: "button",
                                    onClick: executeUpload,
                                    className: "w-56  py-2 text-lg text-white font-semibold text-center rounded-full bg-purple-500 transition-all hover:bg-purple-600 focus:outline-none",
                                    children: "Upload"
                                })
                            })
                        ]
                    })
                ]
            }),
            editImg.index !== null && typeof editImg.index === "number" && editImg?.index > -1 && /*#__PURE__*/ jsx_runtime_.jsx(CropDialog, {
                previousImgSrc: editImg?.blob,
                prevName: editImg.name?.split(".")[0],
                autoOpen: true,
                propSize: filter.size,
                propAspect: Number(filter.aspect),
                onClose: closeSingleEdit
            })
        ]
    });
}


/***/ }),

/***/ 23439:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   $$typeof: () => (/* binding */ $$typeof),
/* harmony export */   __esModule: () => (/* binding */ __esModule),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(84908);

const proxy = (0,next_dist_build_webpack_loaders_next_flight_loader_module_proxy__WEBPACK_IMPORTED_MODULE_0__.createProxy)(String.raw`E:\HTML CSS JS\tanish\app\(preview)\upload\page.tsx`)

// Accessing the __esModule property and exporting $$typeof are required here.
// The __esModule getter forces the proxy target to create the default export
// and the $$typeof value is for rendering logic to determine if the module
// is a client boundary.
const { __esModule, $$typeof } = proxy;
const __default__ = proxy.default;


/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (__default__);

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, [6730,8665,8115,6404,9443,8525,393,2718,788,8170,5779,7425,2498,1447,8581,4642,3850,267,394,1280], () => (__webpack_exec__(57344)));
module.exports = __webpack_exports__;

})();